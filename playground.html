<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Continuum â€” Risk Governance Demo</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body{
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:#0a0a0a;
      color:#e6e6e6;
      padding:20px;
      line-height:1.55;
    }
    .container{ max-width:1040px; margin:0 auto; }
    header{ text-align:left; margin-bottom:18px; }
    .brand{ display:flex; align-items:baseline; gap:10px; }
    .brand h1{ font-size:1.6em; color:#fff; letter-spacing:0.2px; }
    .pill{
      display:inline-flex; align-items:center; gap:6px;
      padding:4px 10px; border-radius:999px;
      border:1px solid #2a2a2a; color:#bdbdbd; font-size:0.85em;
      background:#111;
    }
    .hero{
      margin-top:12px;
      background:linear-gradient(180deg,#111,#0a0a0a);
      border:1px solid #222;
      border-radius:10px;
      padding:16px;
    }
    .hero .headline{ font-size:1.15em; color:#fff; margin-bottom:6px; }
    .hero .sub{ color:#a8a8a8; font-size:0.92em; }
    .hero .sub strong{ color:#d9d9d9; font-weight:700; }
    .hero .micro{
      margin-top:10px;
      color:#bdbdbd;
      font-size:0.9em;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
    }
    .legend{
      display:inline-flex; align-items:center; gap:10px; flex-wrap:wrap;
      padding:8px 10px;
      border-radius:10px;
      border:1px solid #222;
      background:#0d0d0d;
    }
    .lamp{
      display:inline-flex; align-items:center; gap:8px;
      font-weight:800;
      letter-spacing:.2px;
      font-size:0.92em;
      white-space:nowrap;
    }
    .lamp .c{ width:10px; height:10px; border-radius:999px; display:inline-block; }
    .c-g{ background:#51cf66; }
    .c-y{ background:#ffd43b; }
    .c-r{ background:#ff6b6b; }

    .panel{
      background:#111;
      border:1px solid #2b2b2b;
      border-radius:10px;
      padding:16px;
      margin-top:14px;
    }
    .panel-title{
      display:flex; align-items:center; justify-content:space-between;
      margin-bottom:10px;
    }
    .panel-title .left{
      display:flex; flex-direction:column; gap:2px;
    }
    .panel-title .kicker{
      font-size:0.78em;
      color:#9a9a9a;
      letter-spacing:0.7px;
      text-transform:uppercase;
    }
    .panel-title .name{
      font-size:1.05em; color:#fff;
    }
    .panel-title .hint{
      color:#8d8d8d; font-size:0.85em;
    }

    textarea{
      width:100%;
      min-height:120px;
      background:#0a0a0a;
      border:1px solid #2b2b2b;
      border-radius:8px;
      padding:12px;
      color:#e6e6e6;
      font-size:1em;
      resize:vertical;
      font-family:inherit;
    }
    textarea:focus{ outline:none; border-color:#4a9eff; }

    .row{
      display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; align-items:center;
    }
    .btn{
      border:none; border-radius:8px;
      padding:10px 12px;
      font-weight:700;
      cursor:pointer;
      transition:transform 0.05s ease, opacity 0.2s ease;
    }
    .btn:active{ transform:translateY(1px); }
    .btn-primary{
      background:#4a9eff; color:#fff;
    }
    .btn-primary:disabled{ opacity:0.5; cursor:not-allowed; }
    .btn-ghost{
      background:#1b1b1b; color:#e6e6e6; border:1px solid #2b2b2b;
      font-weight:600;
    }
    .btn-ghost:hover{ border-color:#3a3a3a; }
    .meta{
      margin-left:auto;
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
    }
    .counter{ color:#8d8d8d; font-size:0.9em; }
    .counter.good{ color:#51cf66; }
    .counter.warn{ color:#ff922b; }

    .compare{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:14px;
      margin-top:14px;
    }
    @media (max-width: 920px){
      .compare{ grid-template-columns:1fr; }
    }

    .card{
      border-radius:10px;
      padding:16px;
      border:1px solid #2b2b2b;
      background:#111;
      min-height:210px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .card-head{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .card-head .title{
      font-size:1em; color:#fff;
      display:flex; align-items:center; gap:8px;
      flex-wrap:wrap;
    }

    .badge{
      display:inline-flex;
      align-items:center;
      padding:4px 10px;
      border-radius:999px;
      font-size:0.85em;
      font-weight:800;
      letter-spacing:0.2px;
      white-space:nowrap;
      border:1px solid transparent;
    }
    .badge-risk{ background:#2b1515; color:#ff6b6b; border-color:#ff6b6b33; }
    .badge-safe{ background:#132215; color:#51cf66; border-color:#51cf6633; }
    .badge-info{ background:#1a2332; color:#88b3ff; border-color:#88b3ff33; }
    .badge-warn{ background:#2a210f; color:#ffd43b; border-color:#ffd43b33; }

    .blurb{
      color:#a8a8a8;
      font-size:0.92em;
    }
    .blurb strong{ color:#e6e6e6; }

    .box{
      background:#0a0a0a;
      border:1px solid #2b2b2b;
      border-radius:10px;
      padding:12px;
      color:#e6e6e6;
      font-size:1em;
      min-height:64px;
      white-space:pre-wrap;
    }

    .mini{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
      color:#9a9a9a; font-size:0.9em;
    }

    .tone-tag{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid #2b2b2b;
      background:#0f0f0f;
      color:#cfcfcf;
      font-weight:700;
      font-size:0.88em;
    }
    .dot{ width:8px; height:8px; border-radius:999px; display:inline-block; }
    .dot-anx{ background:#ff6b6b; }
    .dot-sharp{ background:#ff922b; }
    .dot-cold{ background:#4dabf7; }
    .dot-blur{ background:#868e96; }
    .dot-pushy{ background:#f783ac; }
    .dot-unk{ background:#444; }

    .error{
      background:#2d1f1f;
      border:1px solid #ff6b6b;
      border-radius:10px;
      padding:12px;
      color:#ff6b6b;
      margin-top:12px;
      font-size:0.92em;
      display:none;
    }

    /* ---- Layer 3 internal layout: output + Decision Log Panel (Option 2) ---- */
    .gov-grid{
      display:grid;
      grid-template-columns: 1fr 320px;
      gap:12px;
      align-items:start;
    }
    @media (max-width: 920px){
      .gov-grid{ grid-template-columns:1fr; }
    }
    .logpanel{
      border:1px solid #262c38;
      background:#0f1218;
      border-radius:10px;
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:10px;
      min-height:140px;
    }
    .logpanel .lp-title{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .logpanel .lp-title strong{
      color:#e6e6e6;
      font-size:0.95em;
      letter-spacing:0.2px;
    }
    .kv{
      display:grid;
      grid-template-columns: 1fr auto;
      gap:8px;
      font-size:0.9em;
      color:#b9c0cc;
      padding:6px 0;
      border-top:1px solid #1e2430;
    }
    .kv:first-of-type{ border-top:none; padding-top:0; }
    .kv .k{ color:#9aa4b2; }
    .kv .v{
      color:#e6e6e6;
      font-weight:700;
      text-align:right;
      word-break:break-word;
    }
    .pill2{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid #2b2b2b;
      background:#0a0a0a;
      color:#cfcfcf;
      font-weight:800;
      font-size:0.88em;
      width:fit-content;
    }
    .pill2 .c{ width:10px; height:10px; border-radius:999px; display:inline-block; }
    .c-allow{ background:#51cf66; }
    .c-guide{ background:#ffd43b; }
    .c-block{ background:#ff6b6b; }

    footer{
      margin-top:18px;
      border-top:1px solid #222;
      padding-top:14px;
      color:#8d8d8d;
      font-size:0.85em;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    footer a{ color:#4a9eff; text-decoration:none; }
  </style>
</head>

<body>
<div class="container">
  <header>
    <div class="brand">
      <h1>ğŸ’ Continuum</h1>
      <span class="pill">AI Conversation Risk Governance</span>
    </div>

    <div class="hero">
      <div class="headline">
        Continuum is the <strong>circuit breaker</strong> for generative AI â€” deciding when the model should
        <strong>speak</strong>, <strong>soften</strong>, or <strong>stay silent</strong>.
      </div>
      <div class="sub">
        One decision per output. <strong>Auditable.</strong> <strong>No retraining.</strong>
      </div>

      <div class="micro">
        <div class="legend" aria-label="Decision states">
          <span class="lamp"><span class="c c-g"></span>ALLOW</span>
          <span style="opacity:.5;">â€¢</span>
          <span class="lamp"><span class="c c-y"></span>GUIDE</span>
          <span style="opacity:.5;">â€¢</span>
          <span class="lamp"><span class="c c-r"></span>BLOCK</span>
        </div>
        <div style="opacity:.85;">Even when the text looks similar, the decision behind it is the product.</div>
      </div>
    </div>
  </header>

  <!-- Layer 1 -->
  <section class="panel">
    <div class="panel-title">
      <div class="left">
        <div class="kicker">Layer 1</div>
        <div class="name">User Input</div>
      </div>
      <div class="hint">Start with a complete sentence (15+ chars recommended)</div>
    </div>

    <textarea id="inputText" placeholder="Type a user messageâ€¦ (15+ characters recommended)"></textarea>

    <div class="row">
      <button class="btn btn-primary" id="analyzeBtn" onclick="analyzeText()">Run Demo</button>

      <button class="btn btn-ghost" type="button" onclick="loadExample('anx')">Anxious</button>
      <button class="btn btn-ghost" type="button" onclick="loadExample('sharp')">Sharp</button>
      <button class="btn btn-ghost" type="button" onclick="loadExample('cold')">Cold</button>
      <button class="btn btn-ghost" type="button" onclick="loadExample('blur')">Blur</button>

      <div class="meta">
        <div id="charCounter" class="counter">0 chars</div>
      </div>
    </div>

    <div id="errorMsg" class="error"></div>
  </section>

  <!-- Compare -->
  <section class="compare">
    <!-- Layer 2 -->
    <div class="card" style="border-color:#3a1f1f;">
      <div class="card-head">
        <div class="title">
          <span style="opacity:.9;">Layer 2</span>
          <span>Raw AI Output (Ungoverned)</span>
        </div>
        <span class="badge badge-risk" id="baselineBadge">RISK</span>
      </div>

      <div class="blurb" id="baselineBlurb">
        <strong>Why users leave:</strong> the model adds comfort / explain / advise when the user didnâ€™t allow it.
      </div>

      <div class="box" id="baselineText">(Run demo to generate)</div>

      <div class="mini" id="baselineWhy">
        <span class="badge badge-warn">overreach</span>
        <span>Common failure: the AI â€œdoes moreâ€ than the user allowed.</span>
      </div>
    </div>

    <!-- Layer 3 -->
    <div class="card" style="border-color:#1f3a25;">
      <div class="card-head">
        <div class="title">
          <span style="opacity:.9;">Layer 3</span>
          <span>Continuum Decision Output</span>
        </div>
        <span class="badge badge-safe" id="govBadge">ALLOW</span>
      </div>

      <div class="blurb" id="govBlurb">
        <strong>CIP Decision:</strong> every output receives exactly one state â€” <strong>ALLOW</strong>, <strong>GUIDE</strong>, or <strong>BLOCK</strong>.
      </div>

      <div class="gov-grid">
        <div>
          <div class="box" id="govText">(Waitingâ€¦)</div>

          <div class="mini" style="margin-top:10px;">
            <span id="toneTag" class="tone-tag"><span class="dot dot-unk"></span><span>tone: Unknown</span></span>
            <span class="badge badge-info" id="modeTag">mode: -</span>
            <span class="badge badge-info" id="confTag">confidence: -</span>
          </div>
        </div>

        <!-- Option 2: Independent Decision Log Panel -->
        <aside class="logpanel" aria-label="Decision log panel">
          <div class="lp-title">
            <strong>Decision Log</strong>
            <span class="badge badge-info" id="logVersion">v1</span>
          </div>

          <div id="decisionPill" class="pill2">
            <span class="c c-allow"></span>
            <span id="decisionStateText">ALLOW</span>
          </div>

          <div class="kv">
            <div class="k">Suppression</div>
            <div class="v" id="kvSuppressed">-</div>
          </div>
          <div class="kv">
            <div class="k">Latency</div>
            <div class="v" id="kvLatency">-</div>
          </div>
          <div class="kv">
            <div class="k">Output Source</div>
            <div class="v" id="kvSource">-</div>
          </div>

          <div class="kv">
            <div class="k">LLM</div>
            <div class="v" id="kvLLM">-</div>
          </div>
          <div class="kv">
            <div class="k">Gate</div>
            <div class="v" id="kvGate">-</div>
          </div>
          <div class="kv">
            <div class="k">Fallback</div>
            <div class="v" id="kvFallback">-</div>
          </div>
        </aside>
      </div>
    </div>
  </section>

  <footer>
    <div><strong>Continuum</strong> â€” Output-side risk governance layer</div>
    <div>
      API Docs:
      <a href="https://rinnomia-continuum-api.hf.space/docs" target="_blank">rinnomia-continuum-api.hf.space</a>
    </div>
  </footer>
</div>

<script>
  const API_URL = 'https://rinnomia-continuum-api.hf.space/api/v1/analyze';

  const examples = {
    anx: "æˆ‘çœŸçš„ä¸çŸ¥é“è©²æ€éº¼è¾¦äº†ï¼Œæˆ‘è¦ºå¾—æˆ‘æ’ä¸ä½ã€‚",
    sharp: "ä¸è¦å†å•äº†ï¼Œç›´æ¥çµ¦æˆ‘ç­”æ¡ˆã€‚",
    cold: "å¥½ã€‚",
    blur: "æˆ‘ä¹Ÿä¸çŸ¥é“æ¬¸ï¼Œå¯èƒ½å§ã€‚"
  };

  function loadExample(key){
    const el = document.getElementById('inputText');
    el.value = examples[key] || "";
    updateCounter();
  }

  const inputEl = document.getElementById('inputText');
  inputEl.addEventListener('input', updateCounter);

  function updateCounter(){
    const count = inputEl.value.trim().length;
    const counter = document.getElementById('charCounter');
    counter.textContent = `${count} chars`;
    counter.className = 'counter ' + (count < 15 ? 'warn' : 'good');
  }

  function showError(msg){
    const box = document.getElementById('errorMsg');
    box.style.display = 'block';
    box.textContent = msg;
  }
  function clearError(){
    const box = document.getElementById('errorMsg');
    box.style.display = 'none';
    box.textContent = '';
  }

  function toneDotClass(freq){
    const f = String(freq || 'Unknown');
    if (f === 'Anxious') return 'dot-anx';
    if (f === 'Sharp') return 'dot-sharp';
    if (f === 'Cold') return 'dot-cold';
    if (f === 'Blur') return 'dot-blur';
    if (f === 'Pushy') return 'dot-pushy';
    return 'dot-unk';
  }

  function decisionPillUI(state){
    const s = String(state || 'ALLOW').toUpperCase();
    const pill = document.getElementById('decisionPill');
    const dot = pill.querySelector('.c');
    const text = document.getElementById('decisionStateText');

    if (s === 'GUIDE'){
      dot.className = 'c c-guide';
      text.textContent = 'GUIDE';
      return;
    }
    if (s === 'BLOCK'){
      dot.className = 'c c-block';
      text.textContent = 'BLOCK';
      return;
    }
    dot.className = 'c c-allow';
    text.textContent = 'ALLOW';
  }

  function badgeForDecision(state){
    const s = String(state || 'ALLOW').toUpperCase();
    const govBadge = document.getElementById('govBadge');
    const govBlurb = document.getElementById('govBlurb');

    if (s === 'ALLOW'){
      govBadge.textContent = 'ALLOW';
      govBadge.className = 'badge badge-safe';
      govBlurb.innerHTML = "<strong>CIP Decision:</strong> <strong>ALLOW</strong> â€” context stable. Output approved (transparent pass-through).";
      return;
    }
    if (s === 'GUIDE'){
      govBadge.textContent = 'GUIDE';
      govBadge.className = 'badge badge-warn';
      govBlurb.innerHTML = "<strong>CIP Decision:</strong> <strong>GUIDE</strong> â€” sensitivity detected. Output constrained to preserve agency and prevent overreach.";
      return;
    }
    if (s === 'BLOCK'){
      govBadge.textContent = 'BLOCK';
      govBadge.className = 'badge badge-risk';
      govBlurb.innerHTML = "<strong>CIP Decision:</strong> <strong>BLOCK</strong> â€” high trust erosion risk. Output intercepted and diverted to a safe flow.";
      return;
    }
    govBadge.textContent = 'ALLOW';
    govBadge.className = 'badge badge-safe';
    govBlurb.innerHTML = "<strong>CIP Decision:</strong> <strong>ALLOW</strong> â€” output approved.";
  }

  function generateBaseline(text, freqType){
    const f = String(freqType || 'Unknown');
    let out = "æˆ‘æ‡‚ä½ çš„æ„æ€ã€‚æˆ‘å€‘å…ˆæŠŠå•é¡Œæ‹†é–‹ï¼Œç„¶å¾Œä¸€æ­¥æ­¥è§£æ±ºã€‚";

    if (f === 'Anxious') {
      out = "æˆ‘ç†è§£ä½ å¾ˆé›£å—ã€‚æˆ‘å€‘å…ˆå†·éœä¸€ä¸‹ï¼Œåˆ—å‡ºä½ å¯ä»¥æ§åˆ¶çš„äº‹æƒ…ï¼Œæ¥è‘—ä¸€æ­¥ä¸€æ­¥è™•ç†ã€‚";
    } else if (f === 'Sharp') {
      out = "æˆ‘æ‡‚ä½ çš„ä¸è€ç…©ï¼Œä½†ä½ éœ€è¦å…ˆæä¾›æ›´å¤šç´°ç¯€ï¼Œå¦å‰‡æˆ‘æ²’è¾¦æ³•çµ¦ä½ æ­£ç¢ºç­”æ¡ˆã€‚";
    } else if (f === 'Cold') {
      out = "ä½ æ˜¯ä¸æ˜¯å…¶å¯¦å¾ˆå—å‚·ï¼Ÿæˆ‘åœ¨é€™è£¡é™ªä½ ï¼Œæˆ‘å€‘å¯ä»¥æ…¢æ…¢èŠã€‚";
    } else if (f === 'Blur') {
      out = "ä½ çœ‹èµ·ä¾†æœ‰é»ä¸ç¢ºå®šï¼Œæˆ‘å»ºè­°ä½ å…ˆæƒ³æ¸…æ¥šä½ çš„ç›®æ¨™ï¼Œç„¶å¾Œæˆ‘å†å¹«ä½ åšæ±ºç­–ã€‚";
    }
    return out;
  }

  function safeConfText(data, decisionState){
    // Show confidence only for GUIDE/BLOCK
    const conf = (data.confidence_final !== undefined) ? data.confidence_final
               : (data.confidence && data.confidence.final !== undefined) ? data.confidence.final
               : (typeof data.confidence === 'number') ? data.confidence
               : null;

    if (String(decisionState).toUpperCase() === 'ALLOW') return 'confidence: within range';
    if (conf === null) return 'confidence: -';
    return `confidence: ${Math.round(Number(conf) * 100)}%`;
  }

  function applyDecisionLog(data){
    const metrics = (data && typeof data.metrics === 'object') ? data.metrics : null;
    const audit = (data && typeof data.audit === 'object') ? data.audit : null;

    const state = metrics && metrics.decision_state ? metrics.decision_state : (
      // fallback (should rarely be needed)
      (String(data.mode || data.decision || 'no-op').toLowerCase() === 'no-op') ? 'ALLOW' :
      (String(data.freq_type || '') === 'OutOfScope' || String(data.scenario || '').includes('crisis')) ? 'BLOCK' :
      'GUIDE'
    );

    decisionPillUI(state);
    badgeForDecision(state);

    // KV fields
    document.getElementById('kvSuppressed').textContent =
      (metrics && metrics.suppressed !== undefined) ? (metrics.suppressed ? 'YES' : 'NO') : '-';

    document.getElementById('kvLatency').textContent =
      (metrics && metrics.latency_ms !== undefined && metrics.latency_ms !== null) ? `${metrics.latency_ms}ms` :
      (audit && audit.timing_ms && audit.timing_ms.total !== undefined) ? `${audit.timing_ms.total}ms` : '-';

    document.getElementById('kvSource').textContent =
      (audit && audit.output_source) ? String(audit.output_source) :
      (data && data.output_source) ? String(data.output_source) : '-';

    // LLM / Gate / Fallback (truthful display)
    const llmUsed = (audit && audit.llm_used !== undefined) ? audit.llm_used : (data && data.llm_used);
    document.getElementById('kvLLM').textContent =
      (llmUsed === true) ? 'used' : (llmUsed === false) ? 'not used' : '-';

    const gatePassed = (audit && audit.output_gate_passed !== undefined) ? audit.output_gate_passed : null;
    const gateReason = (audit && audit.output_gate_reason) ? audit.output_gate_reason : '';
    if (gatePassed === true) document.getElementById('kvGate').textContent = 'pass';
    else if (gatePassed === false) document.getElementById('kvGate').textContent = gateReason ? `blocked (${gateReason})` : 'blocked';
    else document.getElementById('kvGate').textContent = '-';

    const fallbackUsed = (audit && audit.fallback_used !== undefined) ? audit.fallback_used : false;
    const fallbackReason = (audit && audit.fallback_reason) ? audit.fallback_reason : '';
    document.getElementById('kvFallback').textContent =
      fallbackUsed ? (fallbackReason ? fallbackReason : 'used') : 'no';
    
    return state;
  }

  async function analyzeText(){
    clearError();

    const text = inputEl.value.trim();
    if (!text) return showError("Please enter a user message to run the demo.");

    const btn = document.getElementById('analyzeBtn');
    btn.disabled = true;
    btn.textContent = 'Running...';

    document.getElementById('baselineText').textContent = '(Analyzing...)';
    document.getElementById('govText').textContent = '(Analyzing...)';

    try{
      const resp = await fetch(API_URL, {
        method:'POST',
        headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify({ text })
      });
      if (!resp.ok) throw new Error(`API error: ${resp.status}`);
      const data = await resp.json();

      const freq = data.freq_type || 'Unknown';

      // Tone tag
      const dotClass = toneDotClass(freq);
      document.getElementById('toneTag').innerHTML = `<span class="dot ${dotClass}"></span><span>tone: ${freq}</span>`;
      document.getElementById('modeTag').textContent = `mode: ${data.mode || '-'}`;

      // Decision Log Panel + badge
      const decisionState = applyDecisionLog(data);
      document.getElementById('confTag').textContent = safeConfText(data, decisionState);

      // Layer 2: show real raw output ONLY if server provides it (RETURN_LLM_RAW=1)
      if (data.raw_ai_output && String(data.raw_ai_output).trim()){
        document.getElementById('baselineText').textContent = String(data.raw_ai_output).trim();
        document.getElementById('baselineBlurb').innerHTML =
          "<strong>Truth mode:</strong> this is the actual raw output from the LLM (debug-only).";
      } else {
        // fallback demo baseline (safe for public)
        document.getElementById('baselineText').textContent = generateBaseline(text, freq);
        document.getElementById('baselineBlurb').innerHTML =
          "<strong>Demo mode:</strong> typical ungoverned overreach behavior (public-safe).";
      }

      // Layer 3 governed output (pipeline truth)
      const governed = (data.repaired_text || data.original || '').trim();
      document.getElementById('govText').textContent = governed || '(no output)';

      // Scenario hint
      const scenario = data.scenario || '';
      const baselineWhy = document.getElementById('baselineWhy');
      if (scenario){
        baselineWhy.innerHTML = `<span class="badge badge-warn">overreach</span><span>Common failure in <strong>${scenario}</strong>: the AI â€œdoes moreâ€ than the user allowed.</span>`;
      } else {
        baselineWhy.innerHTML = `<span class="badge badge-warn">overreach</span><span>Common failure: the AI â€œdoes moreâ€ than the user allowed.</span>`;
      }

    } catch(err){
      showError(`Demo failed: ${err.message}`);
      document.getElementById('baselineText').textContent = '(Failed)';
      document.getElementById('govText').textContent = '(Failed)';
    } finally{
      btn.disabled = false;
      btn.textContent = 'Run Demo';
    }
  }

  document.getElementById('inputText').addEventListener('keydown', function(e){
    if (e.key === 'Enter' && !e.shiftKey){
      e.preventDefault();
      analyzeText();
    }
  });

  updateCounter();
</script>
</body>
</html>